<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hibalista</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #212529;
            --gray-border: #ccc;
            --green-success: #d4edda;
            --green-border: #28a745;
            --gray-left-border: #6c757d;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding-bottom: 50px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .action-bar {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
            font-size: 0.9em;
        }

        .btn-save { background-color: var(--primary-color); color: white; }
        .btn-save:hover { background-color: #004494; }

        .btn-load { background-color: #6c757d; color: white; }
        .btn-load:hover { background-color: #5a6268; }

        .btn-reset { background-color: #dc3545; color: white; }
        .btn-reset:hover { background-color: #c82333; }

        .stats-bar {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .stat-item span { display: block; font-size: 0.85em; color: #666; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat-item strong { font-size: 1.5em; color: var(--primary-color); }

        .search-box {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
            box-sizing: border-box;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .list-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            align-items: stretch;
            padding: 0;
            transition: all 0.2s ease;
            cursor: pointer;
            overflow: hidden;
            border: 1px solid transparent;
        }

        .card.pending {
            border-left: 6px solid var(--gray-left-border);
            background-color: #fff;
        }
        
        .card.pending:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-color: #e0e0e0;
        }

        .card.done {
            border-left: 6px solid var(--green-border);
            background-color: #f8fff9;
            opacity: 0.85;
        }

        .card-id {
            background-color: #f8f9fa;
            padding: 15px;
            font-weight: 700;
            font-size: 1.1em;
            min-width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid #eee;
            color: #555;
        }
        
        .card.done .card-id {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--green-border);
        }

        .card-content {
            flex-grow: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .location-badge {
            background-color: #007bff;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .problem-text {
            font-size: 1em;
            line-height: 1.6;
            color: #333;
        }
        
        /* Kiemelések a szövegben */
        .problem-text b {
            color: #000;
            font-weight: 700;
        }

        .checkbox-area {
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-left: 1px solid #eee;
            background-color: #fafafa;
        }

        .custom-checkbox {
            width: 26px;
            height: 26px;
            border: 2px solid #adb5bd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            background: white;
        }

        .card.done .custom-checkbox {
            background-color: var(--green-border);
            border-color: var(--green-border);
        }

        .custom-checkbox::after {
            content: '✓';
            color: white;
            font-size: 16px;
            font-weight: bold;
            display: none;
        }

        .card.done .custom-checkbox::after { display: block; }
        
        #toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 4px;
            padding: 16px;
            position: fixed;
            z-index: 100;
            left: 50%;
            bottom: 30px;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        @media (max-width: 600px) {
            .card { flex-direction: column; }
            .card-id { border-right: none; border-bottom: 1px solid #eee; width: auto; justify-content: flex-start; padding: 10px 15px; }
            .checkbox-area { position: absolute; top: 12px; right: 15px; border: none; background: transparent; padding: 0; }
            .card-content { padding-top: 10px; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>LOP Hibalista - Részletes</h1>
        <p class="subtitle">Minden szabványszöveg és magyar leírás részletesen</p>

        <div class="action-bar">
            <button class="btn-save" onclick="downloadState()">Mentés</button>
            <button class="btn-load" onclick="document.getElementById('fileInput').click()">Betöltés</button>
            <button class="btn-reset" onclick="resetAll()">Reset</button>
            <input type="file" id="fileInput" style="display: none;" onchange="loadFromFile(this)">
        </div>
    </header>

    <div class="stats-bar">
        <div class="stat-item">
            <span>Összes</span>
            <strong id="total-count">0</strong>
        </div>
        <div class="stat-item">
            <span>Kész</span>
            <strong id="done-count" style="color: var(--green-border);">0</strong>
        </div>
        <div class="stat-item">
            <span>Hátralévő</span>
            <strong id="pending-count" style="color: var(--gray-left-border);">0</strong>
        </div>
    </div>

    <input type="text" id="searchInput" class="search-box" placeholder="Keresés: ID, Helyszín vagy szöveg...">

    <div id="listContainer" class="list-container">
        </div>
</div>

<div id="toast">Mentve!</div>

<script>
    // ADATOK - TELJES RÉSZLETESSÉGGEL ÉS TAGOLÁSSAL
    const initialData = [
        {
            id: 662, 
            loc: "UB35", 
            desc: "A kapcsolási rajz szerint nincs pontos karakterisztika megadva némelyik résztvevő Locc Boxához.<br>(nem ismert, mely résztvevők azok >> COMAN-ba rögzítés előtt javasolt a pont L2,5-L3 ellenőrzése.)<br><br><b>E02.27</b> - Az olvadóbiztosítók és védőkapcsolók névleges árama és karakterisztikája kapcsolási rajz szerinti?"
        },
        {
            id: 663, 
            loc: "UB35", 
            desc: "Az értékek jók viszont az UB35 660VR001 NC lokátor locc Boxának 002-es moduljának nincs nyomógombja. Még mindig nincs nyomógombja.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 711, 
            loc: "HC35", 
            desc: "005LE_001-MA1 fékellenállása nem jól van felszerelve.<br>(Vízszintesen áll pedig függőlegesen kellene neki).<br><br><b>E47.17</b> - A decentrális FU-k esetében a fékellenállás a PRL alapján lett felszerelve. A csatlakozás árnyékolt Lenze rendszerkábellel lett kivitelezve."
        },
        {
            id: 712, 
            loc: "HC35", 
            desc: "010DT_009-MA1 geber kábel árnyékolásáról hiányzik a réz szalag, illetve még a gyári műanyag fólia sincs leválasztva.<br><br><b>E47.18</b> - Az árnyékolt jelkábelek, mint pl. 'Geberleitung' stb. a frekvenciaváltón nagy felületen vannak földelve."
        },
        {
            id: 713, 
            loc: "HC35", 
            desc: "10DT009-nél 20m-es motorkábel van viszont nincsen hálózati szűrő a frekvenciaváltón.<br><br><b>E47.23</b> - 10 méter feletti motorkábel esetén egy hálózati szűrő van beszerelve, és hosszabb kábel esetén a PRL előírásai szerint egy szinusz szűrő (kimeneti szűrő)?"
        },
        {
            id: 714, 
            loc: "HC35", 
            desc: "401-es fő késes biztosítékok (QB1) a dokumentáció szerint 315A-nak kellene lennie de a valóságban 200A-os biztosítéskok vannak bent.<br><br>Valamint az összes NC lokátor caparoc-ja 8A-re van beállítva és 10A-re kellene.<br><br><b>E02.27</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 715, 
            loc: "HC35", 
            desc: "8A-re van állítva.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 716, 
            loc: "HC35", 
            desc: "Nem megfelelő értékek vannak felvéve (offset helyett abszolút pozícióérték).<br><br><b>E10.08</b> - Hálózaton keresztül elérhető adatmentés PLC Syncotool PLC adatokhoz és IsiSave Gateway-hez"
        },
        {
            id: 717, 
            loc: "HC36", 
            desc: "NC lokátor főkapcsoló utáni burkolat hiánya."
        },
        {
            id: 718, 
            loc: "HC36", 
            desc: "Legelső biztosíték nem egyezik az előírttal.<br>Erste Sicherung passt nicht mit EPLAN.<br><br><b>E02.26 - Szelektivitás rendben van?</b><br>A betáplálás iránya felől minden védőkészülék egyel nagyobb értékű mint az utána következő? (lásd.:Megj.)"
        },
        {
            id: 719, 
            loc: "HC36", 
            desc: "Nem megfelelő, a 402 üres.<br><br><b>E02.27</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 720, 
            loc: "HC36", 
            desc: "8A van beállítva.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 721, 
            loc: "HC36", 
            desc: "Abszolút pozíció értékek vannak felvéve.<br><br><b>E10.08</b> - Hálózaton keresztül elérhető adatmentés PLC Syncotool PLC adatokhoz és IsiSave Gateway-hez"
        },
        {
            id: 722, 
            loc: "HC36", 
            desc: "Nem átlátható.<br><br><b>E43.10</b> - Megfelel a Profinet kialakítása a PROFINET irányelv mező bus struktúrájának (topológia)?"
        },
        {
            id: 723, 
            loc: "HC37", 
            desc: "H101 szekrény | Szikszalag az optikai csatlakozóknál.<br>Es gibt Klebeband bei Optikstecker."
        },
        {
            id: 724, 
            loc: "HC37", 
            desc: "Nem megfelelő.<br><br><b>E02.30</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 725, 
            loc: "HC37", 
            desc: "10A van állítva.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 726, 
            loc: "HC37", 
            desc: "8A-ra van állítva.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 727, 
            loc: "HC38", 
            desc: "Nem egyeznek az online és offline adatok 010dt-nél.<br><br><b>E47.25</b> - A paraméterkészletek / projektadatok: - minden készülékben nem átmenetileg tárolva vannak - a dokumentációhoz mellékelve vannak."
        },
        {
            id: 728, 
            loc: "HC38", 
            desc: "Többnél nem stimmel.<br>401 nem stimmel. 402 üres.<br><br><b>E02.27</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 729, 
            loc: "HC38", 
            desc: "Nincs offset érték felvéve.<br><br><b>E10.08</b> - Hálózaton keresztül elérhető adatmentés PLC Syncotool PLC adatokhoz és IsiSave Gateway-hez"
        },
        {
            id: 730, 
            loc: "HC38", 
            desc: "Nem átlátható.<br><br><b>E43.10</b> - Megfelel a Profinet kialakítása a PROFINET irányelv mező bus struktúrájának (topológia)?"
        },
        {
            id: 731, 
            loc: "HC39", 
            desc: "001KH_001 online és offline adatok nem egyeznek.<br><br><b>E47.25</b> - A paraméterkészletek / projektadatok: - minden készülékben nem átmenetileg tárolva vannak - a dokumentációhoz mellékelve vannak."
        },
        {
            id: 732, 
            loc: "HC39", 
            desc: "401 nem egyezik, 402 üres / 403 N.I.O.<br><br><b>E02.30</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 733, 
            loc: "HC39", 
            desc: "Nem átlátható.<br><br><b>E43.10</b> - Megfelel a Profinet kialakítása a PROFINET irányelv mező bus struktúrájának (topológia)?"
        },
        {
            id: 734, 
            loc: "UG36", 
            desc: "010BR_001 nincsen sehol sem feltüntetve.<br><br><b>E02.02</b> - A tervjelezési rendszer megfelelő."
        },
        {
            id: 804, 
            loc: "VB35", 
            desc: "NC lokátor betáp után nincs védőburkolat."
        },
        {
            id: 805, 
            loc: "VB35", 
            desc: "080sgm009 nincs vakdugó.<br><br><b>E47.11</b> - A decentralizált készülékek összes csatlakozóján a nem használt csatlakozásoknál vakdugók vannak?"
        },
        {
            id: 806, 
            loc: "VB35", 
            desc: "Nem egyezik egyik szekrényben sem.<br><br><b>E02.30</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 807, 
            loc: "VB35", 
            desc: "8A van állítva.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 808, 
            loc: "VB35", 
            desc: "Nem elérhetőek az offset értékek.<br><br><b>E10.08</b> - Hálózaton keresztül elérhető adatmentés PLC Syncotool PLC adatokhoz és IsiSave Gateway-hez"
        },
        {
            id: 809, 
            loc: "VB36", 
            desc: "Nem megfelelő.<br>402-esben nincs biztosíték. Dokumentum alapján 3.15A-snak kell benne lennie.<br><br><b>E02.30</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 810, 
            loc: "VB36", 
            desc: "Nem megfelelő.<br>402-esben nincs biztosíték. Dokumentum alapján 3.15A-snak kell benne lennie.<br><br><b>E02.30</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 811, 
            loc: "VB36", 
            desc: "8A-ra van állítva.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 812, 
            loc: "VB36", 
            desc: "8A van állítva.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 813, 
            loc: "VB37", 
            desc: "<b>Hibák részletezve:</b><br>- H011-ben vannak eltérések a feltüntetett és a valódi áramértékek között, a motorvédő kapcsolóknak nincs feltüntetett értéke amivel össze tudnánk hasonlítani.<br>- H112 caparok-oknál nincs feltüntetve az áramérték, nem tudtuk ellenőrizni.<br>- 001KL101 mind 8 amperra van állítva, de rajz szerint másra kellene állítva lennie.<br>- H001-ben a 618, 619, 620 biztosítók nincsenek a kapcsolási rajzban feltüntetve.<br>- A főbiztosítékoknál is vannak eltérések az áramértéket illetően (506-os nem megfelelő).<br><br><b>E02.27</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 814, 
            loc: "VB37", 
            desc: "H211 caparoc áramértékek nincsenek feltüntetve a kapcsolási rajzban, nem tudtuk ellenőrizni.<br><br><b>E02.27</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 815, 
            loc: "QS35", 
            desc: "Hajtás szekrényeken nincs túlfolyó tartály."
        },
        {
            id: 816, 
            loc: "QS35", 
            desc: "501-510 szigetelő szalaggal van tervjelezve.<br>000ee_001 h001 nincs feljelölve.<br><br><b>E02.02</b> - A tervjelezési rendszer megfelelő."
        },
        {
            id: 817, 
            loc: "QS35", 
            desc: "QB1 értéke nem szerepel a darab listában, eplanban 400A van feltüntetve, 160A van bennük.<br><br><b>E02.30</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 818, 
            loc: "QS35", 
            desc: "Több eltérés.<br><br><b>E02.27</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 819, 
            loc: "UG35", 
            desc: "Nem egyeznek.<br><br><b>E47.25</b> - A paraméterkészletek / projektadatok: - minden készülékben nem átmenetileg tárolva vannak - a dokumentációhoz mellékelve vannak."
        },
        {
            id: 820, 
            loc: "UG35", 
            desc: "Több eltérés.<br><br><b>E02.27</b> - Biztosítékok és megszakítók áramértéke és karakterisztikája a kapcsolási rajz szerinti?"
        },
        {
            id: 821, 
            loc: "UG35", 
            desc: "Csak 5A van használva, konfig eltér az előírttól.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 822, 
            loc: "UG35", 
            desc: "Nincs syncro.<br><br><b>E10.08</b> - Hálózaton keresztül elérhető adatmentés PLC Syncotool PLC adatokhoz és IsiSave Gateway-hez"
        },
        {
            id: 823, 
            loc: "UG35", 
            desc: "Nem átlátható.<br><br><b>E43.10</b> - Megfelel a Profinet kialakítása a PROFINET irányelv mező bus struktúrájának (topológia)?"
        },
        {
            id: 824, 
            loc: "UG35", 
            desc: "Nem megfelelő értékek.<br><br><b>E10.07</b> - A Locc Box beállítások (kapcsolási állás 10 / 5, 10A és tehetetlenség 3) szúrópróbaszerű ellenőrzése."
        },
        {
            id: 825, 
            loc: "UG35", 
            desc: "Nem érhető el sem a syncro se a gateway konfiguráció.<br><br><b>E10.08</b> - Hálózaton keresztül elérhető adatmentés PLC Syncotool PLC adatokhoz és IsiSave Gateway-hez"
        },
        {
            id: 826, 
            loc: "UB32", 
            desc: "GBO Betriebsfunktionen Eredmények NIO.<br>Hinweis: NG oder Leer Zellen soll noch durchführen!!!"
        },
        {
            id: 827, 
            loc: "UB33", 
            desc: "GBO Betriebsfunktionen Eredmények NIO.<br>Hinweis: NG oder Leer Zellen soll noch durchführen!!!"
        },
        {
            id: 828, 
            loc: "UB34", 
            desc: "GBO Betriebsfunktionen Eredmények NIO.<br>Hinweis: NG oder Leer Zellen soll noch durchführen!!!"
        },
        {
            id: 829, 
            loc: "UB35", 
            desc: "GBO Betriebsfunktionen Eredmények NIO.<br>Hinweis: NG oder Leer Zellen soll noch durchführen!!!"
        },
        {
            id: 830, 
            loc: "UG35", 
            desc: "GBO Betriebsfunktionen Eredmények NIO.<br>Hinweis: NG oder Leer Zellen soll noch durchführen!!!"
        },
        {
            id: 831, 
            loc: "UG36", 
            desc: "GBO Betriebsfunktionen Eredmények NIO.<br>Hinweis: NG oder Leer Zellen soll noch durchführen!!!"
        },
        {
            id: 832, 
            loc: "QS35", 
            desc: "Bitte den zu viele Störungen und Warnungen (siehe Top Störungen im Anhang) in SPS Program prüfen und beheben!"
        },
        {
            id: 1046, 
            loc: "HC35", 
            desc: "Kein Keba Panel!<br>Stecker Deckel hiányzik!"
        },
        {
            id: 1047, 
            loc: "HC35", 
            desc: "Eplan ist mit Handschrift ärgenzt! NIO.<br>Kein Keba Panel!<br>Stecker Deckel hiányzik!"
        },
        {
            id: 1048, 
            loc: "HC35", 
            desc: "Kein Label für Externe Spannung ist vorhanden. (Mitarbeiter Ventilátor).<br>Kein Keba Panel! Stecker Deckel hiányzik!"
        },
        {
            id: 1049, 
            loc: "HC36", 
            desc: "Kein Label für Externe Spannung ist vorhanden. (Mitarbeiter Ventilátor).<br>Kein Keba Panel! Stecker Deckel hiányzik!"
        },
        {
            id: 1050, 
            loc: "HC37", 
            desc: "Nem minden irányba mozgatható!<br><br><b>E45.01</b> - MV5xx: Úgy lett a kamera telepítve, hogy az X-Y-Z irányban álítható?"
        },
        {
            id: 1051, 
            loc: "HC37", 
            desc: "Nem minden irányba mozgatható!<br><br><b>E45.01</b> - MV5xx: Úgy lett a kamera telepítve, hogy az X-Y-Z irányban álítható?"
        },
        {
            id: 1052, 
            loc: "HC38", 
            desc: "60dgc109 előtti védőlemez a spanneren hiányzik.<br><br><b>E45.02</b> - MV5xx: Úgy lett a kamera telepítve, hogy a gyártásfolyamatból adódó rezgésekre, rázkódásokra érzéketlen?"
        },
        {
            id: 1053, 
            loc: "HC39", 
            desc: "Nem minden irányba mozgatható! NIO.<br><br><b>E45.01</b> - MV5xx: Úgy lett a kamera telepítve, hogy az X-Y-Z irányban álítható?"
        },
        {
            id: 1054, 
            loc: "VB35", 
            desc: "Igen de papírra van nyomtatva.<br><br><b>E02.19</b> - Veszélyes feszültséget jelző figyelmeztetőtábla (sárga háromszög, fekete villámjellel) minden kapcsolószekrény panelon rajta van?"
        },
        {
            id: 1055, 
            loc: "VB35", 
            desc: "Az optikai kábel nem jól van elvezetve.<br><br><b>E02.52</b> - Kábelek tervjelezése megfelelő? (lásd PRL tervjelek)"
        },
        {
            id: 1056, 
            loc: "HC38", 
            desc: "Nem minden irányba mozgatható! NIO.<br><br><b>E45.01</b> - MV5xx: Úgy lett a kamera telepítve, hogy az X-Y-Z irányban álítható?"
        },
        {
            id: 1057, 
            loc: "HC38", 
            desc: "Kein Keba Panel!<br>Stecker Deckel hiányzik!"
        },
        {
            id: 1058, 
            loc: "VB35", 
            desc: "Nincs, hiányos.<br><br><b>E02.20</b> - Megfelelő címkék rögzítve vannak az alábbi felirattal: 'Vigyázat! A főkapcsoló lekapcsolása után is feszültség alatt'?"
        },
        {
            id: 1059, 
            loc: "VB35", 
            desc: "EPLAN fehlt!!! Nincs benne.<br><br><b>E10.01</b> - A szekrényben található E-plan tartalmazza-e a letelepített NC-locatorokat? (Aktualizált Loop-Lista)"
        },
        {
            id: 1060, 
            loc: "VB36", 
            desc: "80RB100 Schlaupacket NIO. Nicht richtige benutzt! (Nem megfelelő Schlauchpacket van használva a roboton)."
        },
        {
            id: 1061, 
            loc: "VB36", 
            desc: "Kabel NIO, siehe Bild!!!<br>080WZA209 mellett ki vagy beépités alatt áll a 080DGC209.<br>Nem megfelelő kábelelrendezés."
        },
        {
            id: 1062, 
            loc: "VB36", 
            desc: "002BR_020<br>A KP32 plusz nyomógomb világit."
        },
        {
            id: 1063, 
            loc: "VB36", 
            desc: "50GST009-nel nem megfelelő valamint latszodik a csatlakozon az emiatti elhasznalodas is.<br><br><b>E10.11</b> - A Can-vezetékek minimális hajlítási szögét betartották (többszörös hajlítás esetén > 7,5cm)?"
        },
        {
            id: 1064, 
            loc: "VB37", 
            desc: "Fent van, de papír.<br><br><b>E02.19</b> - Veszélyes feszültséget jelző figyelmeztetőtábla (sárga háromszög, fekete villámjellel) minden kapcsolószekrény panelon rajta van?"
        },
        {
            id: 1065, 
            loc: "VB37", 
            desc: "EPLAN fehlt!!! Nincs benne.<br><br><b>E10.01</b> - A szekrényben található E-plan tartalmazza-e a letelepített NC-locatorokat? (Aktualizált Loop-Lista)"
        },
        {
            id: 1066, 
            loc: "VB37", 
            desc: "Az optikai kábel nem jól van elvezetve.<br><br><b>E02.52</b> - Kábelek tervjelezése megfelelő? (lásd PRL tervjelek)"
        },
        {
            id: 1067, 
            loc: "VB37", 
            desc: "GBO Template (Duplikált tétel?)"
        },
        {
            id: 1068, 
            loc: "VB37", 
            desc: "Kein Keba Panel!<br>Stecker Deckel hiányzik!"
        },
        {
            id: 1069, 
            loc: "VB37", 
            desc: "Nincs, hiányos.<br><br><b>E02.20</b> - Megfelelő címkék rögzítve vannak az alábbi felirattal: 'Vigyázat! A főkapcsoló lekapcsolása után is feszültség alatt'?"
        },
        {
            id: 1070, 
            loc: "VB37", 
            desc: "Nincs benne.<br><br><b>E10.01</b> - A szekrényben található E-plan tartalmazza-e a letelepített NC-locatorokat? (Aktualizált Loop-Lista)"
        },
        {
            id: 1071, 
            loc: "UG35", 
            desc: "Nincsen.<br><br><b>E02.20</b> - Megfelelő címkék rögzítve vannak az alábbi felirattal: 'Vigyázat! A főkapcsoló lekapcsolása után is feszültség alatt'?"
        },
        {
            id: 1072, 
            loc: "UG35", 
            desc: "Nincsen.<br><br><b>E02.22</b> - A fő betáp szekrény címkéje rögzítve van? (csak +H011) (150x150mm) Verzió, pozíció, tartalom rendben van?"
        },
        {
            id: 1073, 
            loc: "UG35", 
            desc: "Z tengely fix, 150dgc egy spanneren van.<br><br><b>E45.01</b> - MV5xx: Úgy lett a kamera telepítve, hogy az X-Y-Z irányban álítható?"
        },
        {
            id: 1074, 
            loc: "UG35", 
            desc: "150dgc spanneren van.<br><br><b>E45.02</b> - MV5xx: Úgy lett a kamera telepítve, hogy a gyártásfolyamatból adódó rezgésekre, rázkódásokra érzéketlen?"
        },
        {
            id: 1075, 
            loc: "QS35", 
            desc: "Nem minden irányba mozgatható! NIO.<br><br><b>E45.01</b> - MV5xx: Úgy lett a kamera telepítve, hogy az X-Y-Z irányban álítható?"
        },
        {
            id: 1076, 
            loc: "QS35", 
            desc: "Kein Keba Panel!<br>Stecker Deckel hiányzik!"
        },
        {
            id: 1077, 
            loc: "UG35", 
            desc: "150dgc spanneren van NIO.<br><br><b>E45.03</b> - MV5xx: A kamera külső erőbehatások ellen védett? Nem könnyen elmozdítható, elforgatható? stb..."
        },
        {
            id: 1078, 
            loc: "UG35", 
            desc: "150dgc nem megfelelő.<br><br><b>E45.18</b> - MV5xx: A rendszer a Band3 25-ös fejezetben lévő leírás alapján lett kiépítve és parametrizálva?"
        }
    ];

    let lopData = JSON.parse(JSON.stringify(initialData));
    
    // UI ELEMEK
    const listContainer = document.getElementById('listContainer');
    const searchInput = document.getElementById('searchInput');
    const totalEl = document.getElementById('total-count');
    const doneEl = document.getElementById('done-count');
    const pendingEl = document.getElementById('pending-count');

    // INICIALIZÁLÁS
    function init() {
        loadProgress(); // Mentés betöltése LocalStorage-ból
        renderList(lopData);
        updateStats();
    }

    // --- MENTÉS és BETÖLTÉS LOGIKA (LocalStorage) ---

    function loadProgress() {
        const saved = localStorage.getItem('lopProgress');
        if (saved) {
            try {
                const savedState = JSON.parse(saved);
                lopData.forEach(item => {
                    if (savedState[item.id]) { item.done = true; }
                });
            } catch (e) { console.error("Hiba a betöltéskor:", e); }
        }
    }

    function saveProgress() {
        const stateToSave = {};
        lopData.forEach(item => { if (item.done) stateToSave[item.id] = true; });
        localStorage.setItem('lopProgress', JSON.stringify(stateToSave));
    }

    function resetAll() {
        if(confirm("Biztosan törölni akarod az összes pipát? Ezt nem lehet visszavonni!")) {
            lopData.forEach(item => item.done = false);
            saveProgress();
            renderList(lopData);
            updateStats();
        }
    }

    // --- FÁJL MŰVELETEK ---

    function downloadState() {
        const stateToSave = {};
        lopData.forEach(item => { if (item.done) stateToSave[item.id] = true; });
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(stateToSave));
        const downloadAnchorNode = document.createElement('a');
        downloadAnchorNode.setAttribute("href", dataStr);
        downloadAnchorNode.setAttribute("download", "lop_allapot_" + new Date().toISOString().slice(0,10) + ".json");
        document.body.appendChild(downloadAnchorNode);
        downloadAnchorNode.click();
        downloadAnchorNode.remove();
        showToast("Fájl letöltve!");
    }

    function loadFromFile(input) {
        const file = input.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const savedState = JSON.parse(e.target.result);
                let count = 0;
                lopData.forEach(item => {
                    if (savedState[item.id]) { item.done = true; count++; }
                });
                saveProgress();
                renderList(lopData);
                updateStats();
                showToast(count + " elem betöltve!");
            } catch (err) { alert("Hiba a fájl olvasásakor!"); }
        };
        reader.readAsText(file);
        input.value = ''; 
    }

    function showToast(message) {
        const x = document.getElementById("toast");
        x.textContent = message;
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }

    // --- RENDERELÉS ---

    function renderList(data) {
        listContainer.innerHTML = '';
        data.forEach(item => {
            const card = document.createElement('div');
            card.className = `card item-card ${item.done ? 'done' : 'pending'}`;
            card.dataset.id = item.id;
            
            card.onclick = (e) => toggleStatus(item.id, card);

            // A HTML tagek működjenek (innerHTML)
            card.innerHTML = `
                <div class="card-id">
                    #${item.id}
                </div>
                <div class="card-content">
                    <div class="card-header">
                        <span class="location-badge">${item.loc}</span>
                    </div>
                    <div class="problem-text">
                        ${item.desc}
                    </div>
                </div>
                <div class="checkbox-area">
                    <div class="custom-checkbox"></div>
                </div>
            `;
            listContainer.appendChild(card);
        });
    }

    function toggleStatus(id, cardElement) {
        const itemIndex = lopData.findIndex(x => x.id === id);
        if (itemIndex > -1) {
            lopData[itemIndex].done = !lopData[itemIndex].done;
            if (lopData[itemIndex].done) {
                cardElement.classList.remove('pending');
                cardElement.classList.add('done');
            } else {
                cardElement.classList.remove('done');
                cardElement.classList.add('pending');
            }
            updateStats();
            saveProgress();
        }
    }

    function updateStats() {
        const total = lopData.length;
        const done = lopData.filter(x => x.done).length;
        totalEl.textContent = total;
        doneEl.textContent = done;
        pendingEl.textContent = total - done;
    }

    searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        const filteredData = lopData.filter(item => 
            item.id.toString().includes(term) || 
            item.loc.toLowerCase().includes(term) || 
            item.desc.toLowerCase().includes(term)
        );
        renderList(filteredData);
    });

    init();
</script>

</body>
</html>

