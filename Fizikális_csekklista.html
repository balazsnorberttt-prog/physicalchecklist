<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOP Hibalista Kezelő (Mentéssel)</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333;
            --gray-border: #ccc;
            --green-success: #d4edda;
            --green-border: #28a745;
            --gray-left-border: #6c757d;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 20px;
        }

        .action-bar {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
            font-size: 0.9em;
        }

        .btn-save {
            background-color: var(--primary-color);
            color: white;
        }
        .btn-save:hover { background-color: #004494; }

        .btn-load {
            background-color: #6c757d;
            color: white;
        }
        .btn-load:hover { background-color: #5a6268; }

        .btn-reset {
            background-color: #dc3545;
            color: white;
        }
        .btn-reset:hover { background-color: #c82333; }

        .stats-bar {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .stat-item span {
            display: block;
            font-size: 0.9em;
            color: #666;
        }

        .stat-item strong {
            font-size: 1.4em;
            color: var(--primary-color);
        }

        .search-box {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
            box-sizing: border-box;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .list-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            padding: 0;
            transition: all 0.3s ease;
            cursor: pointer;
            overflow: hidden;
            position: relative;
        }

        .card.pending {
            border-left: 6px solid var(--gray-left-border);
            background-color: #fff;
        }
        
        .card.pending:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }

        .card.done {
            border-left: 6px solid var(--green-border);
            background-color: var(--green-success);
            opacity: 0.9;
        }

        .card-id {
            background-color: #f0f0f0;
            padding: 20px 15px;
            font-weight: bold;
            font-size: 1.1em;
            min-width: 60px;
            text-align: center;
            border-right: 1px solid #eee;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
        }
        
        .card.done .card-id {
            background-color: rgba(255,255,255,0.5);
            color: var(--green-border);
        }

        .card-content {
            flex-grow: 1;
            padding: 15px 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .location-badge {
            background-color: #007bff;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .problem-text {
            font-size: 1em;
            line-height: 1.5;
            color: #444;
        }

        .checkbox-area {
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .custom-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #aaa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .card.done .custom-checkbox {
            background-color: var(--green-border);
            border-color: var(--green-border);
        }

        .custom-checkbox::after {
            content: '✔';
            color: white;
            font-size: 14px;
            display: none;
        }

        .card.done .custom-checkbox::after {
            display: block;
        }
        
        /* Toast notification */
        #toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
            border-radius: 8px;
        }

        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }

        @keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }

        @media (max-width: 600px) {
            .card { flex-direction: column; align-items: stretch; }
            .card-id { border-right: none; border-bottom: 1px solid #eee; flex-direction: row; justify-content: space-between; padding: 10px 15px; }
            .checkbox-area { position: absolute; top: 10px; right: 10px; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Hibalista Kezelő</h1>
        <p class="subtitle">Balázs Norbert</p>

        <div class="action-bar">
            <button class="btn-save" onclick="downloadState()">Mentés</button>
            <button class="btn-load" onclick="document.getElementById('fileInput').click()">Betöltés</button>
            <button class="btn-reset" onclick="resetAll()">Törlés</button>
            <input type="file" id="fileInput" style="display: none;" onchange="loadFromFile(this)">
        </div>
    </header>

    <div class="stats-bar">
        <div class="stat-item">
            <span>Összes elem</span>
            <strong id="total-count">0</strong>
        </div>
        <div class="stat-item">
            <span>Kész</span>
            <strong id="done-count" style="color: var(--green-border);">0</strong>
        </div>
        <div class="stat-item">
            <span>Hátravan</span>
            <strong id="pending-count" style="color: var(--gray-left-border);">0</strong>
        </div>
    </div>

    <input type="text" id="searchInput" class="search-box" placeholder="Keresés ID, Helyszín vagy Szöveg alapján...">

    <div id="listContainer" class="list-container">
        </div>
</div>

<div id="toast">Mentve!</div>

<script>
    // Az adatok
    const initialData = [
        {id: 662, loc: "UB35", desc: "SPS1 IW7 - Hardware NOK. A kapcsolási rajz szerint nincs pontos karakterisztika megadva némelyik résztvevőhöz. Olvadóbiztosítók és védőkapcsolók ellenőrzése szükséges."},
        {id: 663, loc: "UB35", desc: "SPS1 IW7 - NC-Lokatoren NOK. A Locc Box 002-es moduljának nincs nyomógombja. Locc Box beállítások szúrópróbaszerű ellenőrzése."},
        {id: 711, loc: "HC35", desc: "SPS1 IW7 - Antriebstechnik NOK. 005LE_001-MA1 fékellenállása nem jól van felszerelve (vízszintesen áll, függőlegesen kellene)."},
        {id: 712, loc: "HC35", desc: "SPS1 IW7 - Antriebstechnik NOK. 010DT_009-MA1 geber kábel árnyékolásáról hiányzik a réz szalag, gyári műanyag fólia nincs leválasztva."},
        {id: 713, loc: "HC35", desc: "SPS1 IW7 - Antriebstechnik NOK. 10DT009-nél 20M-es motorkábel van, viszont nincsen hálózati szűrő a frekvenciaváltón."},
        {id: 714, loc: "HC35", desc: "SPS1 IW7 - Hardware NOK. 401-es fő késes biztosítékok (QB1) a dokumentáció szerint 315A, de valóságban 200A. NC lokátor caparoc beállítás rossz (8A helyett 10A kell)."},
        {id: 715, loc: "HC35", desc: "SPS1 IW7 - NC-Lokatoren NOK. 8A-re van állítva (10A helyett)."},
        {id: 716, loc: "HC35", desc: "SPS1 IW7 - NC-Lokatoren NOK. Nem megfelelő értékek vannak felvéve (offset helyett abszolút pozícióérték)."},
        {id: 717, loc: "HC36", desc: "SPS1 Egyéni NOK. NC lokátor főkapcsoló utáni burkolat hiánya."},
        {id: 718, loc: "HC36", desc: "SPS1 IW7 - Hardware NOK. Legelső biztosíték nem egyezik az előírttal (Szelektivitás)."},
        {id: 719, loc: "HC36", desc: "SPS1 IW7 - Hardware NOK. Nem megfelelő, a 402 üres. Biztosítékok ellenőrzése."},
        {id: 720, loc: "HC36", desc: "SPS1 IW7 - NC-Lokatoren NOK. 8A van beállítva (Locc Box)."},
        {id: 721, loc: "HC36", desc: "SPS1 IW7 - NC-Lokatoren NOK. Abszolút pozíció értékek vannak felvéve offset helyett."},
        {id: 722, loc: "HC36", desc: "SPS1 IW7 - Profinet/Profisafe NOK. Topológia nem átlátható, nem felel meg a szabványnak."},
        {id: 723, loc: "HC37", desc: "SPS1 Egyéni NOK. H101 szekrény: szikszalag az optikai csatlakozóknál."},
        {id: 724, loc: "HC37", desc: "SPS1 IW7 - Hardware NOK. Nem megfelelő biztosíték értékek/beállítások."},
        {id: 725, loc: "HC37", desc: "SPS1 IW7 - NC-Lokatoren NOK. 10A van állítva (ellenőrizni)."},
        {id: 726, loc: "HC37", desc: "SPS2 IW7 - NC-Lokatoren NOK. 8A-ra van állítva."},
        {id: 727, loc: "HC38", desc: "SPS1 IW7 - Antriebstechnik NOK. Nem egyeznek az online és offline adatok a 010dt-nél."},
        {id: 728, loc: "HC38", desc: "SPS1 IW7 - Hardware NOK. Többnél nem stimmel (pl. 401). 402 üres."},
        {id: 729, loc: "HC38", desc: "SPS1 IW7 - NC-Lokatoren NOK. Nincs offset érték felvéve."},
        {id: 730, loc: "HC38", desc: "SPS1 IW7 - Profinet/Profisafe NOK. Topológia nem átlátható, nem szabványos."},
        {id: 731, loc: "HC39", desc: "SPS1 IW7 - Antriebstechnik NOK. 001KH_001 online és offline adatok nem egyeznek."},
        {id: 732, loc: "HC39", desc: "SPS1 IW7 - Hardware NOK. 401 nem egyezik, 402 üres, 403 NOK."},
        {id: 733, loc: "HC39", desc: "SPS1 IW7 - Profinet/Profisafe NOK. Topológia nem átlátható."},
        {id: 734, loc: "UG36", desc: "SPS1 IW7 - Hardware NOK. 010BR_001 nincsen sehol sem feltüntetve (hiányos jelölés)."},
        {id: 804, loc: "VB35", desc: "SPS1 Egyéni NOK. NC lokátor betáp után nincs védőburkolat."},
        {id: 805, loc: "VB35", desc: "SPS1 IW7 - Antriebstechnik NOK. 080sgm009 nincs vakdugó."},
        {id: 806, loc: "VB35", desc: "SPS1 IW7 - Hardware NOK. Biztosíték értékek nem egyeznek egyik szekrényben sem."},
        {id: 807, loc: "VB35", desc: "SPS1 IW7 - NC-Lokatoren NOK. 8A van állítva."},
        {id: 808, loc: "VB35", desc: "SPS1 IW7 - NC-Lokatoren NOK. Nem elérhetőek az offset értékek."},
        {id: 809, loc: "VB36", desc: "SPS2 IW7 - Hardware NOK. 402-esben nincs biztosíték (3.15A kellene)."},
        {id: 810, loc: "VB36", desc: "SPS2 IW7 - Hardware NOK. 402-es hiányzó biztosíték ismétlés."},
        {id: 811, loc: "VB36", desc: "SPS2 IW7 - NC-Lokatoren NOK. 8A-ra van állítva."},
        {id: 812, loc: "VB36", desc: "SPS3 IW7 - NC-Lokatoren NOK. 8A-ra van állítva."},
        {id: 813, loc: "VB37", desc: "SPS1 IW7 - Hardware NOK. H011 eltérések feltüntetett/valós áramértékek közt. Motorvédőkön nincs érték. H112 Caparoc érték hiányzik. 001KL101 8A-re állítva (rossz)."},
        {id: 814, loc: "VB37", desc: "SPS2 IW7 - Hardware NOK. H211 Caparoc áramértékek nincsenek feltüntetve a rajzban."},
        {id: 815, loc: "QS35", desc: "SPS1 Egyéni NOK. Hajtás szekrényeken nincs túlfolyó tartály."},
        {id: 816, loc: "QS35", desc: "SPS1 IW7 - Hardware NOK. 501-510 szigetelőszalaggal jelölve, 000ee_001 h001 nincs feljelölve."},
        {id: 817, loc: "QS35", desc: "SPS1 IW7 - Hardware NOK. QB1 értéke hiányzik a darablistából (Eplan: 400A, Valós: 160A)."},
        {id: 818, loc: "QS35", desc: "SPS1 IW7 - Hardware NOK. Több eltérés a biztosíték értékekben."},
        {id: 819, loc: "UG35", desc: "SPS1 IW7 - Antriebstechnik NOK. Paraméterkészletek nem egyeznek."},
        {id: 820, loc: "UG35", desc: "SPS1 IW7 - Hardware NOK. Több biztosíték eltér a rajztól."},
        {id: 821, loc: "UG35", desc: "SPS1 IW7 - NC-Lokatoren NOK. Csak 5A van használva, konfig eltér az előírttól."},
        {id: 822, loc: "UG35", desc: "SPS1 IW7 - NC-Lokatoren NOK. Nincs syncro (adatmentés)."},
        {id: 823, loc: "UG35", desc: "SPS1 IW7 - Profinet/Profisafe NOK. Topológia nem átlátható."},
        {id: 824, loc: "UG35", desc: "SPS2 IW7 - NC-Lokatoren NOK. Nem megfelelő értékek."},
        {id: 825, loc: "UG35", desc: "SPS2 IW7 - NC-Lokatoren NOK. Nem érhető el sem a syncro se a gateway konfiguráció."},
        {id: 826, loc: "UB32", desc: "GBO Betriebsfunktionen: NG vagy üres cellák (Papírmentes doku, Mobsy, Profienergy ellenőrzés)."},
        {id: 827, loc: "UB33", desc: "GBO Betriebsfunktionen: NG vagy üres cellák."},
        {id: 828, loc: "UB34", desc: "GBO Betriebsfunktionen: NG vagy üres cellák."},
        {id: 829, loc: "UB35", desc: "GBO Betriebsfunktionen: NG vagy üres cellák."},
        {id: 830, loc: "UG35", desc: "GBO Betriebsfunktionen: NG vagy üres cellák."},
        {id: 831, loc: "UG36", desc: "GBO Betriebsfunktionen: NG vagy üres cellák."},
        {id: 832, loc: "QS35", desc: "Túl sok zavar és figyelmeztetés az SPS programban (Top Störungen)."},
        {id: 1046, loc: "HC35", desc: "Nincs Keba Panel! Stecker fedél hiányzik!"},
        {id: 1047, loc: "HC35", desc: "Eplan kézírással kiegészítve (NIO). Nincs Keba Panel, fedél hiányzik."},
        {id: 1048, loc: "HC35", desc: "Nincs Label az 'Externe Spannung'-hoz (Ventilátor). Nincs Keba Panel."},
        {id: 1049, loc: "HC36", desc: "Nincs Label az 'Externe Spannung'-hoz. Nincs Keba Panel."},
        {id: 1050, loc: "HC37", desc: "SPS1 IW7 - Identtechnik NOK. Kamera nem mozgatható minden irányba (X-Y-Z)."},
        {id: 1051, loc: "HC37", desc: "SPS2 IW7 - Identtechnik NOK. Kamera nem mozgatható minden irányba."},
        {id: 1052, loc: "HC38", desc: "SPS1 IW7 - Identtechnik NOK. 60dgc109 előtti védőlemez a spanneren hiányzik."},
        {id: 1053, loc: "HC39", desc: "SPS1 IW7 - Identtechnik NOK. Kamera nem állítható minden irányba."},
        {id: 1054, loc: "VB35", desc: "SPS1 IW7 - Hardware NOK. Feszültség figyelmeztető tábla papírra van nyomtatva."},
        {id: 1055, loc: "VB35", desc: "SPS1 IW7 - Hardware NOK. Optikai kábel nem jól van elvezetve."},
        {id: 1056, loc: "HC38", desc: "SPS1 IW7 - Identtechnik NOK. Kamera állíthatóság probléma."},
        {id: 1057, loc: "HC38", desc: "Nincs Keba Panel! Stecker fedél hiányzik!"},
        {id: 1058, loc: "VB35", desc: "SPS1 IW7 - Hardware NOK. 'Vigyázat feszültség alatt' címkék hiányosak."},
        {id: 1059, loc: "VB35", desc: "SPS1 IW7 - NC-Lokatoren NOK. EPLAN hiányzik (NC-locator lista)."},
        {id: 1060, loc: "VB36", desc: "SPS2 Egyéni NOK. 80RB100 Schlauchpaket NIO. Nem megfelelő típus a roboton."},
        {id: 1061, loc: "VB36", desc: "SPS2 Egyéni NOK. 080WZA209 mellett nem megfelelő kábelelrendezés (080DGC209)."},
        {id: 1062, loc: "VB36", desc: "SPS2 Egyéni NOK. 002BR_020 A KP32 plusz nyomógomb világít (hiba)."},
        {id: 1063, loc: "VB36", desc: "SPS2 IW7 - NC-Lokatoren NOK. 50GST009-nél nem megfelelő hajlítási sugár (elhasználódás látható)."},
        {id: 1064, loc: "VB37", desc: "SPS1 IW7 - Hardware NOK. Feszültség jelző tábla papír alapú."},
        {id: 1065, loc: "VB37", desc: "SPS1 IW7 - NC-Lokatoren NOK. EPLAN hiányzik."},
        {id: 1066, loc: "VB37", desc: "SPS1 IW7 - Hardware NOK. Optikai kábel nem jól vezetve."},
        {id: 1067, loc: "VB37", desc: "SPS1 (Duplikált/Hiányos bejegyzés, GBO Template)."},
        {id: 1068, loc: "VB37", desc: "Nincs Keba Panel! Stecker fedél hiányzik."},
        {id: 1069, loc: "VB37", desc: "SPS1 IW7 - Hardware NOK. 'Vigyázat feszültség' címkék hiányosak."},
        {id: 1070, loc: "VB37", desc: "SPS1 IW7 - NC-Lokatoren NOK. EPLAN hiányzik."},
        {id: 1071, loc: "UG35", desc: "SPS1 IW7 - Hardware NOK. Feszültség figyelmeztető címkék nincsenek."},
        {id: 1072, loc: "UG35", desc: "SPS1 IW7 - Hardware NOK. Fő betáp szekrény címkéje hiányzik (+H011)."},
        {id: 1073, loc: "UG35", desc: "SPS1 IW7 - Identtechnik NOK. Z tengely fix, 150dgc egy spanneren van."},
        {id: 1074, loc: "UG35", desc: "SPS1 IW7 - Identtechnik NOK. 150dgc rezgésvédelem probléma (spanneren van)."},
        {id: 1075, loc: "QS35", desc: "SPS1 IW7 - Identtechnik NOK. Kamera nem minden irányba állítható."},
        {id: 1076, loc: "QS35", desc: "Nincs Keba Panel! Stecker fedél hiányzik."},
        {id: 1077, loc: "UG35", desc: "SPS1 IW7 - Identtechnik NOK. 150dgc védelem külső behatás ellen (könnyen elmozdítható)."},
        {id: 1078, loc: "UG35", desc: "SPS1 IW7 - Identtechnik NOK. 150dgc nem megfelelő rendszer kiépítés (Band3 alapján)."}
    ];

    let lopData = JSON.parse(JSON.stringify(initialData));
    
    // UI elemek
    const listContainer = document.getElementById('listContainer');
    const searchInput = document.getElementById('searchInput');
    const totalEl = document.getElementById('total-count');
    const doneEl = document.getElementById('done-count');
    const pendingEl = document.getElementById('pending-count');

    // Inicializálás
    function init() {
        // Megpróbáljuk betölteni a mentett állapotot
        loadProgress();
        renderList(lopData);
        updateStats();
    }

    // --- MENTÉS és BETÖLTÉS LOGIKA (LocalStorage) ---

    // Betöltés böngészőből
    function loadProgress() {
        const saved = localStorage.getItem('lopProgress');
        if (saved) {
            try {
                const savedState = JSON.parse(saved);
                // Összefésülés: Csak a 'done' státuszt vesszük át, ha egyezik az ID
                lopData.forEach(item => {
                    if (savedState[item.id]) {
                        item.done = true;
                    }
                });
            } catch (e) {
                console.error("Hiba a betöltéskor:", e);
            }
        }
    }

    // Mentés böngészőbe
    function saveProgress() {
        const stateToSave = {};
        lopData.forEach(item => {
            if (item.done) {
                stateToSave[item.id] = true;
            }
        });
        localStorage.setItem('lopProgress', JSON.stringify(stateToSave));
    }

    // Törlés
    function resetAll() {
        if(confirm("Biztosan törölni akarod az összes pipát? Ezt nem lehet visszavonni!")) {
            lopData.forEach(item => item.done = false);
            saveProgress();
            renderList(lopData);
            updateStats();
        }
    }

    // --- FÁJL MENTÉS/BETÖLTÉS LOGIKA ---

    // Letöltés JSON fájlként
    function downloadState() {
        const stateToSave = {};
        lopData.forEach(item => {
            if (item.done) {
                stateToSave[item.id] = true;
            }
        });
        
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(stateToSave));
        const downloadAnchorNode = document.createElement('a');
        downloadAnchorNode.setAttribute("href", dataStr);
        downloadAnchorNode.setAttribute("download", "lop_allapot_" + new Date().toISOString().slice(0,10) + ".json");
        document.body.appendChild(downloadAnchorNode); // required for firefox
        downloadAnchorNode.click();
        downloadAnchorNode.remove();
        showToast("Fájl letöltve!");
    }

    // Betöltés fájlból
    function loadFromFile(input) {
        const file = input.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const savedState = JSON.parse(e.target.result);
                // Reseteljük először, vagy csak hozzáadjuk? Inkább összefésüljük (hozzáadjuk).
                let count = 0;
                lopData.forEach(item => {
                    if (savedState[item.id]) {
                        item.done = true;
                        count++;
                    }
                });
                
                saveProgress(); // Elmentjük a LocalStorage-ba is
                renderList(lopData);
                updateStats();
                showToast(count + " elem sikeresen betöltve!");
            } catch (err) {
                alert("Hiba a fájl olvasásakor! Biztosan megfelelő JSON?");
            }
        };
        reader.readAsText(file);
        // Reset input
        input.value = ''; 
    }

    function showToast(message) {
        const x = document.getElementById("toast");
        x.textContent = message;
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }

    // --- UI RENDERELÉS ---

    function renderList(data) {
        listContainer.innerHTML = '';
        data.forEach(item => {
            const card = document.createElement('div');
            card.className = `card item-card ${item.done ? 'done' : 'pending'}`;
            card.dataset.id = item.id;
            
            card.onclick = (e) => toggleStatus(item.id, card);

            card.innerHTML = `
                <div class="card-id">
                    #${item.id}
                </div>
                <div class="card-content">
                    <div class="card-header">
                        <span class="location-badge">${item.loc}</span>
                    </div>
                    <div class="problem-text">
                        ${item.desc}
                    </div>
                </div>
                <div class="checkbox-area">
                    <div class="custom-checkbox"></div>
                </div>
            `;
            listContainer.appendChild(card);
        });
    }

    function toggleStatus(id, cardElement) {
        const itemIndex = lopData.findIndex(x => x.id === id);
        if (itemIndex > -1) {
            lopData[itemIndex].done = !lopData[itemIndex].done;
            
            if (lopData[itemIndex].done) {
                cardElement.classList.remove('pending');
                cardElement.classList.add('done');
            } else {
                cardElement.classList.remove('done');
                cardElement.classList.add('pending');
            }
            
            updateStats();
            saveProgress(); // Mentés minden kattintáskor
        }
    }

    function updateStats() {
        const total = lopData.length;
        const done = lopData.filter(x => x.done).length;
        
        totalEl.textContent = total;
        doneEl.textContent = done;
        pendingEl.textContent = total - done;
    }

    searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        const filteredData = lopData.filter(item => 
            item.id.toString().includes(term) || 
            item.loc.toLowerCase().includes(term) || 
            item.desc.toLowerCase().includes(term)
        );
        renderList(filteredData);
    });

    // Start
    init();

</script>

</body>

</html>
